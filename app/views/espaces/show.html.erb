
<div class="banner-img" style="background-image: url(<%= image_path @espace.picture.url(:large) %>);">

</div>
<div class="header">
  <div class="container">
    <div class="row first">
      <div class="col-xs-12 col-md-2 col-md-offset-2 text-center">
        <%= image_tag @espace.user.put_picture(:thumb), class: "img-avatar" %>
        <p><%= @espace.user.first_name %></p>
      </div>
      <div class="col-xs-12 col-md-6 ">
        <div class="row">
          <div class="col-xs-12">
            <h1><%= @espace.name %></h1>
            <p><%= @espace.address %></p>
            <% if current_user == @espace.user %>
              <%= link_to(edit_espace_path(@espace), class: 'edit_my_espace')   do %>
                <%= t('.edit_my_espace') %>
              <% end %>
            <% end %>
          </div>
        </div>
        <div class="row">
          <div class="col-xs-12">
            <p id="category"><%= @espace.category %></p>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>
<div class="content">
  <div class="row">
    <div class="col-xs-12 col-sm-8 col-sm-offset-2 col-md-6 col-md-offset-3">
      <div class="card">
        <p id="description"> Description </p>
        <p> <%= @espace.description %></p>
      </div>
    </div>
  </div>
  <div class="row">
    <% if @espace.art_pieces.size != 0 %>
      <div class="col-xs-12 col-sm-8 col-sm-offset-2 col-md-6 col-md-offset-3">
        <div class="card">
          <div id="carousel-example-generic" class="carousel slide" data-ride="carousel">
            <!-- Indicators -->
            <ol class="carousel-indicators">
              <li data-target="#carousel-example-generic" data-slide-to="0" class="active"></li>
              <% for i in 1...@espace.art_pieces.size do %>
                <li data-target="#carousel-example-generic" data-slide-to="<%= i %>"></li>
              <% end %>
            </ol>

          <!-- Wrapper for slides -->
          <div class="carousel-inner" role="listbox">
            <% @espace.art_pieces.each_with_index do |art_piece,i|%>
              <% if i == 0 %>
                <div id="<%= art_piece.id %>" class= "item active">
              <% else %>
                <div id="<%= art_piece.id%>" class= "item">
              <% end %>
                  <%= image_tag art_piece.picture.url(:medium) %>
                  <div class="carousel-caption">
                    <%= art_piece.title %>
                  </div>
                </div>
            <% end %>
          </div>

          <!-- Controls -->
          <a class="left carousel-control" href="#carousel-example-generic" role="button" data-slide="prev">
            <span class="fa fa-arrow-left" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
          </a>
          <a class="right carousel-control" href="#carousel-example-generic" role="button" data-slide="next">
            <span class="fa fa-arrow-right" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
          </a>
        </div>
      </div>
    </div>
    <% end %>
  </div>
<!-- form to add an art_piece -->
  <div class="row">
    <div class="col-xs-12 col-sm-8 col-sm-offset-2 col-md-6 col-md-offset-3">
      <div class="card">
        <% if @espace.user == current_user %>
          <p><%= @message_to_user %></p>
          <%= simple_form_for(@art_piece) do |f| %>
            <%= f.hidden_field :espace_id, :value => @espace.id.to_i %>
            <div class="form-group" id="input-show">
              <%= f.label  :title %><br>
              <%= f.input :title, label: false %>
            </div>
            <div class="form-group">
              <%= f.label :picture %>
              <%= f.file_field :picture %>
            </div>
            <%= f.submit "Confirm", :class => "btn btn-success"  %>
          <% end %>
        <% end %>
      </div>
    </div>
  </div>


  <button class="btn btn-success direction-cta"><%= t('.get_directions') %></button>
  <div class="row">
    <div class="col-xs-12 col-sm-8 col-sm-offset-2 col-md-6 col-md-offset-3">
      <div class="card">
        <div id="map" style="width: 100%; height: 400px;"></div>
      </div>
    </div>
  </div>
</div>

<div id="map" style="width: 100%; height: 100%;"></div>

<% content_for(:after_js) do %>
  <%= javascript_tag do %>
    $(document).on('ready', function() {
      handler = Gmaps.build('Google');
      handler.buildMap({ internal: { id: 'map' } }, function(){
        markers = handler.addMarkers(<%= raw @markers.to_json %>);
        handler.bounds.extendWith(markers);
        handler.fitMapToBounds();
        handler.getMap().setZoom(14)
      });
    })
  <% end %>
<% end %>